realm: celine

# =============================================================================
# SCOPES
# =============================================================================
# Convention: {service}.{resource}.{action} or {service}.{action}
# Special: {service}.admin grants full access to that service
# =============================================================================

scopes:
  # Digital Twin
  - name: digital-twin.admin
    description: Full access to Digital Twin service
  - name: digital-twin.values.read
    description: Read digital twin values
  - name: digital-twin.values.write
    description: Write digital twin values
  - name: digital-twin.simulation.read
    description: Read simulation data
  - name: digital-twin.simulation.write
    description: Write simulation data
  - name: digital-twin.simulation.run
    description: Execute simulations
  - name: digital-twin.app.run
    description: Execute digital twin apps

  # Pipeline
  - name: pipelines.admin
    description: Full access to Pipeline service
  - name: pipelines.runs.admin
    description: Admin pipeline runs
  - name: pipelines.runs.read
    description: Read pipeline runs
  - name: pipelines.runs.write
    description: Update pipeline runs
  - name: pipelines.job.read
    description: Read job details
  - name: pipelines.job.write
    description: Modify job configuration
  - name: pipelines.job.execute
    description: Trigger job execution

  # Dataset
  - name: dataset.admin
    description: Full access to Dataset service (includes restricted datasets)
  - name: dataset.query
    description: Execute dataset queries
  - name: dataset.read
    description: Read dataset metadata and schema
  - name: dataset.write
    description: Write dataset data

  # REC Registry
  - name: rec_registry.admin
    description: Full administrative access to the REC Registry, including configuration, user management, and destructive operations.
  - name: rec_registry.import
    description: Permission to import Renewable Energy Certificate (REC) data into the registry from external systems or bulk files.
  - name: rec_registry.export
    description: Permission to export Renewable Energy Certificate (REC) data from the registry for reporting, auditing, or downstream processing.

  # MQTT
  - name: mqtt.admin
    description: MQTT superuser access

# =============================================================================
# CLIENTS
# =============================================================================
# Each client gets scopes for:
#   1. Its own resources (what it manages)
#   2. Dependencies (other services it needs to call)
# =============================================================================

clients:
  - client_id: svc-digital-twin
    name: Digital Twin Service
    secret: ${SVC_DT_SECRET:-svc-digital-twin}
    default_scopes:
      # Own resources
      - digital-twin.admin
      # Dependencies
      - dataset.query # needs to read datasets

  - client_id: svc-pipelines
    name: Pipeline Orchestrator
    secret: ${SVC_PIPELINES_SECRET:-svc-pipelines}
    default_scopes:
      # Own resources
      - pipelines.runs.read
      - pipelines.runs.write
      - pipelines.job.execute
      # Dependencies
      - dataset.query # needs to read datasets
      - digital-twin.simulation.run # needs to trigger simulations

  - client_id: svc-dataset-api
    name: Dataset API Service
    secret: ${SVC_DATASET_SECRET:-svc-dataset-api}
    default_scopes:
      - dataset.admin # owns datasets

  - client_id: svc-nudging
    name: Nudging Service
    secret: ${SVC_NUDGING_SECRET:-svc-nudging}
    default_scopes:
      # Dependencies only
      - digital-twin.values.read # reads DT state
      - dataset.query # reads datasets

  - client_id: svc-rec-registry
    name: REC Registry  Service
    secret: ${SVC_DT_SECRET:-svc-rec-registry}
    default_scopes:
      # Own resources
      - rec_registry.admin

  - client_id: celine-cli
    name: CELINE Admin CLI
    secret: ${CELINE_ADMIN_CLI_SECRET:-celine-cli}
    default_scopes:
      - digital-twin.admin
      - pipelines.admin
      - dataset.admin
      - mqtt.admin
      - rec_registry.admin
